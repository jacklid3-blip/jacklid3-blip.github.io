; ============================================
; Cisco Device Basic Housekeeping - Tera Term Macro
; ============================================

; --- Configuration Variables (EDIT THESE) ---
hostname = 'R1'
enable_secret = 'Secret'
console_password = 'Cisco'
vty_password = 'Cisco'
motd_banner = '*** Authorized Access Only! ***'
login_banner = '*** Login to Network Device ***'

; --- Connection Settings ---
; Uncomment and edit ONE of these based on your connection type:

; For Serial/Console connection:
; comport = 5
; connect '/C='comport

; For Telnet connection:
; host = '192.168.1.1'
; connect host ':23 /nossh'

; For SSH connection:
host = '192.168.1.1'
username = 'admin'
connect host ':22 /ssh'

; ============================================
; MAIN SCRIPT STARTS HERE
; ============================================

; Wait for the device prompt
wait '>' '#'
pause 1

; Enter privileged EXEC mode
sendln 'enable'
wait 'Password:' '#'
; If password prompt appears, you may need to enter current enable password
; sendln 'current_enable_password'
; wait '#'
pause 1

; Enter global configuration mode
sendln 'configure terminal'
wait '(config)#'
pause 1

; --- Set Hostname ---
sprintf2 cmd 'hostname %s' hostname
sendln cmd
wait '(config)#'
pause 1

; --- Set Enable Secret ---
sprintf2 cmd 'enable secret %s' enable_secret
sendln cmd
wait '(config)#'
pause 1

; --- Configure MOTD Banner ---
sendln 'banner motd #'
wait '#'
sendln motd_banner
sendln '#'
wait '(config)#'
pause 1

; --- Configure Login Banner ---
sendln 'banner login #'
wait '#'
sendln login_banner
sendln '#'
wait '(config)#'
pause 1

; --- Configure Console Line ---
sendln 'line console 0'
wait '(config-line)#'
pause 1

sprintf2 cmd 'password %s' console_password
sendln cmd
wait '(config-line)#'

sendln 'login'
wait '(config-line)#'

sendln 'logging synchronous'
wait '(config-line)#'

sendln 'exec-timeout 5 0'
wait '(config-line)#'

sendln 'exit'
wait '(config)#'
pause 1

; --- Configure VTY Lines ---
sendln 'line vty 0 4'
wait '(config-line)#'
pause 1

sprintf2 cmd 'password %s' vty_password
sendln cmd
wait '(config-line)#'

sendln 'login'
wait '(config-line)#'

sendln 'transport input telnet ssh'
wait '(config-line)#'

sendln 'exec-timeout 5 0'
wait '(config-line)#'

sendln 'exit'
wait '(config)#'
pause 1

; --- Enable Password Encryption ---
sendln 'service password-encryption'
wait '(config)#'
pause 1

; --- Exit Configuration Mode ---
sendln 'end'
wait '#'
pause 1

; --- Save Configuration ---
sendln 'write memory'
wait '[OK]' '#'
pause 2

; --- Display completion message ---
messagebox 'Cisco housekeeping configuration complete!' 'Success'

; End of script
